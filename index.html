<!DOCTYPE html><html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Jurnal Trading ‚Äî Glass UI</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root{
      --bg1:#071028; --bg2:#0b1b3a; --glass: rgba(255,255,255,0.06);
      --accent: #6ee7ff; --accent-2:#8fff9b; --muted:#9aa6bf; --card-border: rgba(255,255,255,0.08);
      --success:#23c171; --danger:#ff6b6b; --glass-blur:10px;
      --glass-shadow: 0 8px 40px rgba(2,6,23,0.6);
      --glass-radius:14px;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{
      background: linear-gradient(135deg,var(--bg1),var(--bg2));
      color: #e9f0fb; -webkit-font-smoothing:antialiased;
      min-height:100vh; display:flex; flex-direction:column; align-items:center; padding:28px 20px;
      overflow-y:auto;
    }/* Particle canvas fills background */
#bg-canvas{position:fixed; inset:0; z-index:0; pointer-events:none}

.app{position:relative; z-index:2; width:100%; max-width:1200px}

header{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:18px}
.brand{display:flex;gap:12px;align-items:center}
.logo{width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;font-weight:800;color:#022;box-shadow:0 8px 30px rgba(138,235,255,0.08)}
h1{font-size:20px;margin:0;color:var(--accent);letter-spacing:0.2px}
p.lead{margin:0;color:var(--muted);font-size:13px}

/* glass card */
.card{backdrop-filter: blur(var(--glass-blur)); background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02)); border-radius:var(--glass-radius); border:1px solid var(--card-border); box-shadow:var(--glass-shadow); padding:14px}

/* Form */
.form-wrap{margin-top:8px}
form.grid{display:grid;grid-template-columns:repeat(6,1fr);gap:12px}
label{font-size:12px;color:var(--muted);margin-bottom:6px;display:block}
input,select,button,textarea{border-radius:10px;padding:10px 12px;border:1px solid rgba(255,255,255,0.04);background:rgba(6,12,26,0.45);color:var(--text);outline:none}
input::placeholder{color:#7f8fa6}
input:focus,select:focus,textarea:focus{box-shadow:0 6px 18px rgba(0,0,0,0.45);}
.col-1{grid-column:span 1}
.col-2{grid-column:span 2}
.col-3{grid-column:span 3}
.col-6{grid-column:span 6}

.actions{display:flex;gap:10px;align-items:center}
.btn{cursor:pointer;border:none;padding:10px 14px;border-radius:10px;font-weight:700}
.btn-primary{background: linear-gradient(90deg,var(--accent),var(--accent-2)); color:#022; box-shadow:0 8px 26px rgba(110,231,255,0.08)}
.btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--accent)}
.btn-warn{background:linear-gradient(90deg,#ffd166,#ffb347); color:#16322b}
.btn-danger{background:linear-gradient(90deg,#ff7b7b,#ffb3b3); color:#3b0a0a}

/* Filters bar */
.filters{display:flex;gap:10px;align-items:end;margin-top:16px}
.filters input, .filters select{padding:8px 10px;border-radius:10px}
.spacer{flex:1}

/* table */
.table-wrap{margin-top:16px;overflow:auto;border-radius:12px}
table{width:100%;border-collapse:collapse;min-width:900px}
th,td{padding:12px 10px;border-bottom:1px solid rgba(255,255,255,0.04);text-align:center;font-size:13px}
thead th{position:sticky;top:0;background:rgba(255,255,255,0.02);color:var(--accent);font-weight:700}
tbody tr{transition:background .18s ease, transform .18s ease}
tbody tr:hover{background:rgba(255,255,255,0.02);transform:translateY(-2px)}
.small{font-size:12px;color:var(--muted)}

/* stats & chart */
.grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:18px}
.stat-big{font-size:18px;font-weight:800;color:var(--accent)}
.chart-wrap{margin-top:18px}

/* toast */
#toast{position:fixed;right:24px;bottom:24px;padding:12px 16px;border-radius:10px;background:var(--success);color:#022;font-weight:700;opacity:0;transform:translateY(12px);transition:all .4s ease;z-index:999}
#toast.show{opacity:1;transform:translateY(0)}

/* responsive */
@media (max-width:980px){form.grid{grid-template-columns:repeat(2,1fr)} .col-6{grid-column:span 2} table{min-width:720px}}
@media (max-width:560px){form.grid{grid-template-columns:1fr} .filters{flex-direction:column;align-items:stretch}}

  </style>
</head>
<body>
  <canvas id="bg-canvas"></canvas>
  <div class="app">
    <header>
      <div class="brand">
        <div class="logo">JT</div>
        <div>
          <h1>Jurnal Trading ‚Äî Glass UI</h1>
          <p class="lead">Simpan, edit, filter, dan pantau equity. (Data lokal ‚Äî tersimpan di browser)</p>
        </div>
      </div>
      <div style="display:flex;gap:8px;align-items:center">
        <button class="btn btn-ghost" id="exportCSV">Export CSV</button>
        <button class="btn btn-ghost" id="exportJSON">Export JSON</button>
        <button class="btn btn-danger" id="clearAll">Reset</button>
      </div>
    </header><!-- INPUT FORM -->
<section class="card form-wrap">
  <form id="tradeForm" class="grid">
    <div class="col-1">
      <label>Pair</label>
      <input id="pair" placeholder="EURUSD" required />
    </div>
    <div class="col-1">
      <label>Lot</label>
      <input id="lot" type="number" step="0.01" placeholder="0.10" required />
    </div>
    <div class="col-1">
      <label>Entry</label>
      <input id="entry" type="number" step="0.00001" placeholder="1.08500" required />
    </div>
    <div class="col-1">
      <label>Exit</label>
      <input id="exit" type="number" step="0.00001" placeholder="1.08900" required />
    </div>
    <div class="col-1">
      <label>P/L (manual)</label>
      <input id="pl" type="number" step="0.01" placeholder="25.50" required />
    </div>
    <div class="col-1">
      <label>Catatan</label>
      <input id="notes" placeholder="Alasan / setup" />
    </div>

    <div class="col-6" style="display:flex;gap:10px;">
      <button type="submit" class="btn btn-primary" id="saveBtn">üíæ Simpan Trade</button>
      <button type="button" class="btn btn-warn" id="updateBtn" style="display:none">‚úèÔ∏è Update Trade</button>
      <div style="flex:1"></div>
    </div>
  </form>
</section>

<!-- FILTERS -->
<section class="filters card">
  <div class="field small">
    <label class="small">Dari</label>
    <input type="date" id="fromDate" />
  </div>
  <div class="field small">
    <label class="small">Sampai</label>
    <input type="date" id="toDate" />
  </div>
  <div class="field small">
    <label class="small">Pair</label>
    <select id="pairFilter"><option value="">Semua</option></select>
  </div>
  <div class="field grow2">
    <label class="small">Search (pair / catatan)</label>
    <input id="searchBox" placeholder="ketik untuk mencari..." />
  </div>
  <div class="spacer"></div>
  <div style="display:flex;gap:8px;align-items:center">
    <button class="btn btn-ghost" id="resetFilter">Reset</button>
  </div>
</section>

<!-- TABLE -->
<section class="table-wrap card">
  <table id="tradeTable">
    <thead>
      <tr>
        <th>#</th>
        <th>Tanggal</th>
        <th>Pair</th>
        <th>Lot</th>
        <th>Entry</th>
        <th>Exit</th>
        <th>P/L</th>
        <th>Catatan</th>
        <th>Aksi</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</section>

<!-- STATS -->
<section class="grid-3">
  <div class="card"><h3>Total Trade</h3><p id="totalTrades">0</p></div>
  <div class="card"><h3>Total P/L</h3><p id="totalPL">0</p></div>
  <div class="card"><h3>Winrate</h3><p id="winRate">0%</p></div>
</section>

<!-- CHART -->
<section class="chart-wrap card">
  <canvas id="equityChart" height="120"></canvas>
</section>

  </div>  <div id="toast" aria-live="polite"></div>  <script>
    // ===== Background particles (subtle) =====
    const canvas = document.getElementById('bg-canvas');
    const ctx = canvas.getContext('2d');
    let W, H, particles=[];
    function resize(){ W=canvas.width = innerWidth; H=canvas.height = innerHeight; }
    window.addEventListener('resize', resize); resize();

    function rand(min,max){return Math.random()*(max-min)+min}
    class P{constructor(){this.reset()} reset(){this.x=rand(0,W);this.y=rand(0,H);this.r=rand(0.4,1.8);this.vx=rand(-0.2,0.2);this.vy=rand(-0.05,0.05);this.alpha=rand(0.06,0.18)} update(){this.x+=this.vx;this.y+=this.vy; if(this.x< -10) this.x=W+10; if(this.x>W+10) this.x=-10; if(this.y<-20) this.y=H+20; if(this.y>H+20) this.y=-20} draw(){ctx.beginPath();ctx.fillStyle='rgba(110,231,255,'+this.alpha+')';ctx.arc(this.x,this.y,this.r,0,Math.PI*2);ctx.fill()}};
    function initParticles(){particles=[]; const count=Math.floor((W*H)/90000); for(let i=0;i<count;i++) particles.push(new P());}
    initParticles();
    function tick(){ctx.clearRect(0,0,W,H); for(const p of particles){p.update();p.draw()} requestAnimationFrame(tick)}; tick();

    // ===== App logic =====
    const KEY='fx_journal_v2_glass';
    let trades = JSON.parse(localStorage.getItem(KEY) || '[]');
    let editIndex = null;

    // elements
    const tblBody = document.querySelector('#tradeTable tbody');
    const totalTradesEl = document.getElementById('totalTrades');
    const totalPLEl = document.getElementById('totalPL');
    const winRateEl = document.getElementById('winRate');
    const form = document.getElementById('tradeForm');
    const saveBtn = document.getElementById('saveBtn');
    const updateBtn = document.getElementById('updateBtn');
    const fromDate = document.getElementById('fromDate');
    const toDate = document.getElementById('toDate');
    const pairFilter = document.getElementById('pairFilter');
    const searchBox = document.getElementById('searchBox');
    const resetFilter = document.getElementById('resetFilter');
    const toast = document.getElementById('toast');

    // chart
    let chart;
    function showToast(msg, color='var(--success)'){toast.textContent=msg;toast.style.background=color;toast.classList.add('show');setTimeout(()=>toast.classList.remove('show'),2200)}

    function animateValue(el, start, end, ms=400, isPct=false){let s=null; function step(ts){ if(!s) s=ts; const p=Math.min((ts-s)/ms,1); const v = start + (end-start)*p; el.textContent = isPct ? v.toFixed(1)+'%' : v.toFixed(2); if(p<1) requestAnimationFrame(step); } requestAnimationFrame(step)}

    function newId(){return Math.random().toString(36).slice(2)+Date.now().toString(36)}
    function nowISO(){return new Date().toISOString()}
    function fmtDateISO(iso){const d=new Date(iso); const pad=(n)=>String(n).padStart(2,'0'); return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}`}

    function persist(){ localStorage.setItem(KEY, JSON.stringify(trades)); }
    function collectPairs(){ const s=new Set(trades.map(t=>t.pair).filter(Boolean)); pairFilter.innerHTML='<option value="">Semua</option>'+[...s].sort().map(p=>`<option value="${p}">${p}</option>`).join(''); }

    function getFiltered(){ const fd = fromDate.value ? new Date(fromDate.value+'T00:00:00') : null; const td = toDate.value ? new Date(toDate.value+'T23:59:59') : null; const pf = pairFilter.value || ''; const q = searchBox.value.trim().toLowerCase(); return trades.filter(t=>{ const d=new Date(t.date); if(fd && d<fd) return false; if(td && d>td) return false; if(pf && t.pair!==pf) return false; if(q){ const hay = (t.pair + ' ' + (t.notes||'')).toLowerCase(); if(!hay.includes(q)) return false } return true }) }

    function renderTable(){ tblBody.innerHTML=''; const rows = getFiltered(); rows.forEach((t,i)=>{ const tr=document.createElement('tr'); tr.classList.add('new-row'); tr.innerHTML = `<td>${i+1}</td><td class="small">${fmtDateISO(t.date)}</td><td>${t.pair}</td><td>${t.lot}</td><td>${t.entry}</td><td>${t.exit}</td><td>${Number(t.pl).toFixed(2)}</td><td>${t.notes||''}</td><td style="display:flex;gap:8px;justify-content:center"><button class="btn btn-warn" onclick="window.editTrade('${t.id}')">Edit</button><button class="btn btn-danger" onclick="window.deleteTrade('${t.id}')">Hapus</button></td>`; tblBody.appendChild(tr) });
      // stats
      const totalPL = rows.reduce((s,r)=>s+Number(r.pl||0),0); const wins = rows.filter(r=>Number(r.pl)>0).length; const wr = rows.length ? (wins/rows.length)*100 : 0; document.getElementById('totalTrades').textContent = rows.length; animateValue(totalPLEl, parseFloat(totalPLEl.textContent)||0, totalPL, 450); animateValue(winRateEl, parseFloat(winRateEl.textContent)||0, wr, 450, true);
      renderChart(rows); persist(); collectPairs(); }

    function renderChart(rows){ const ctx = document.getElementById('equityChart').getContext('2d'); const equity=[]; let run=0; rows.forEach(r=>{ run += Number(r.pl||0); equity.push(run) }); if(chart) chart.destroy(); chart = new Chart(ctx,{ type:'line', data:{ labels: rows.map((_,i)=>i+1), datasets:[{ label:'Equity', data: equity, borderColor: getComputedStyle(document.documentElement).getPropertyValue('--accent')||'#6ee7ff', backgroundColor: 'rgba(110,231,255,0.08)', tension:0.35, fill:true, pointRadius:3 }] }, options:{ responsive:true, animation:{ duration:800 }, plugins:{ legend:{ display:false }}, scales:{ x:{ grid:{ color:'rgba(255,255,255,0.03)' }}, y:{ grid:{ color:'rgba(255,255,255,0.03)' }}} } }); }

    // CRUD
    form.addEventListener('submit', e=>{ e.preventDefault(); const t={ id:newId(), date: nowISO(), pair: document.getElementById('pair').value.trim().toUpperCase(), lot: parseFloat(document.getElementById('lot').value), entry: parseFloat(document.getElementById('entry').value), exit: parseFloat(document.getElementById('exit').value), pl: parseFloat(document.getElementById('pl').value), notes: document.getElementById('notes').value.trim() }; trades.push(t); form.reset(); renderTable(); showToast('Trade tersimpan ‚úÖ'); });

    window.deleteTrade = function(id){ trades = trades.filter(x=>x.id!==id); renderTable(); showToast('Trade dihapus ‚ùå','var(--danger)') }
    window.editTrade = function(id){ const idx = trades.findIndex(x=>x.id===id); if(idx===-1) return; const t = trades[idx]; document.getElementById('pair').value = t.pair; document.getElementById('lot').value = t.lot; document.getElementById('entry').value = t.entry; document.getElementById('exit').value = t.exit; document.getElementById('pl').value = t.pl; document.getElementById('notes').value = t.notes||''; editIndex = idx; saveBtn.style.display='none'; updateBtn.style.display='inline-block'; showToast('Mode edit aktif ‚úèÔ∏è','var(--yellow)') }

    updateBtn.addEventListener('click', ()=>{ if(editIndex===null) return; trades[editIndex] = { ...trades[editIndex], pair: document.getElementById('pair').value.trim().toUpperCase(), lot: parseFloat(document.getElementById('lot').value), entry: parseFloat(document.getElementById('entry').value), exit: parseFloat(document.getElementById('exit').value), pl: parseFloat(document.getElementById('pl').value), notes: document.getElementById('notes').value.trim() }; form.reset(); editIndex=null; saveBtn.style.display='inline-block'; updateBtn.style.display='none'; renderTable(); showToast('Trade diupdate ‚úèÔ∏è','var(--yellow)') })

    // filters
    [fromDate,toDate,pairFilter,searchBox].forEach(el=>{ el.addEventListener('input', renderTable); el.addEventListener('change', renderTable) })
    resetFilter.addEventListener('click', ()=>{ fromDate.value=''; toDate.value=''; pairFilter.value=''; searchBox.value=''; renderTable(); })

    // exports & reset
    document.getElementById('exportCSV').addEventListener('click', ()=>{
      const hdr=['id','date','pair','lot','entry','exit','pl','notes'];
      const rows = trades.map(t=>hdr.map(h=>JSON.stringify(t[h]??'')).join(','));
      const csv = [hdr.join(','), ...rows].join('\n'); const blob = new Blob([csv],{type:'text/csv'}); const a= document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='fx-journal.csv'; a.click(); URL.revokeObjectURL(a.href);
    })
    document.getElementById('exportJSON').addEventListener('click', ()=>{ const blob=new Blob([JSON.stringify(trades,null,2)],{type:'application/json'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='fx-journal.json'; a.click(); URL.revokeObjectURL(a.href) })
    document.getElementById('clearAll').addEventListener('click', ()=>{ if(confirm('Hapus semua data jurnal?')){ trades=[]; persist(); renderTable(); showToast('Semua data direset','var(--danger)') } })

    // init
    collectPairs(); renderTable();
  </script></body>
</html>